<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Отзывы | Психологический центр "Гармония"</title>
    <link href="main.css" rel="stylesheet" type="text/css">
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <nav>
                <ul>
                <li><a href="index.html">Главная</a></li>
                <li><a href="index.html#about">О психологе</a></li>
                <li><a href="index.html#services">Услуги</a></li>
                <li><a href="index.html#schedule">Расписание</a></li>
                <li><a href="Регистрация.html">Регистрация</a></li>
                <li><a href="Личный кабинет.html">Запись на прием</a></li>
                <li><a href="Контакты.html">Контакты</a></li>
                <li><a href="Отзыв.html">Отзывы</a></li>
                </ul>
            </nav>
        </aside>

        <main class="content">
            <h1>Отзывы о наших психологах</h1>            
            
            <section id="add-review">
                <h2>Оставить отзыв</h2>
                <form id="review-form">
                    <label for="review-name">Ваше имя:</label>
                    <input type="text" id="review-name" name="name" required>
                    
                    <label for="review-psychologist">Выберите психолога:</label>
                    <select id="review-psychologist" name="psychologist" required>
                        <option value="">-- Выберите психолога --</option>
                        <option value="michael">Михаил Новиков</option>
                        <option value="vasia">Василий Пронин</option>
                        <option value="dima">Дмитрий Демидов</option>
                        <option value="maks">Максим Леонтьев</option>
                    </select>                 
                    
                    <label for="review-text">Текст отзыва:</label>
                    <textarea id="review-text" name="text" rows="5" required></textarea>
                    <div class="censorship-warning" id="censorship-warning" style="display: none; color: #e74c3c; margin: 10px 0; padding: 10px; background: #ffeaea; border-radius: 5px;">
    Пожалуйста, уберите нецензурные выражения из отзыва
</div>
                    <button type="submit">Опубликовать отзыв</button>
                </form>
            </section>

            
            <section id="reviews-list">
                <h2>Все отзывы</h2>
                <div class="reviews-container" id="reviews-container">
                    
                </div>
            </section>
        </main>
    </div>
    <script>

    function getPsychologistName(key) {
        const psychologists = {
            'michael': 'Михаил Новиков',
            'vasia': 'Василий Пронин', 
            'dima': 'Дмитрий Демидов',
            'maks': 'Максим Леонтьев'
        };
        return psychologists[key] || key;
    }

    // Функция для цензуры текста с помощью регулярных выражений
    function censorText(text) {
        const badWordPatterns = [
            /бляд/gi,    // блядь
            /ху[ейя]/gi, // хуй,
            /пизд/gi,    // пизда
            /[её]б/gi,   // ебать, ёб
            /муда/gi,    // мудак
            /говн/gi,    // говно
            /жоп/gi,     // жопа
            /сук/gi,     // сука
            /черт/gi,    // черт
            /дерьм/gi    // дерьмо
        ];
        
        let censoredText = text;
        
        badWordPatterns.forEach(pattern => {
            censoredText = censoredText.replace(pattern, (match) => {
                return '*'.repeat(match.length);
            });
        });
        
        return censoredText;
    }

    // Функция проверки на наличие нецензурных слов
    function hasBadWords(text) {
        const badWordPatterns = [
            /бляд/gi,
            /ху[ейя]/gi,
            /пизд/gi,
            /[её]б/gi,
            /муда/gi,
            /говн/gi,
            /жоп/gi,
            /сук/gi,
            /черт/gi,
            /дерьм/gi
        ];
        
        return badWordPatterns.some(pattern => pattern.test(text));
    }

    function deleteReview(index) {
        if (confirm('Удалить этот отзыв?')) {
            let reviews = JSON.parse(localStorage.getItem('reviews')) || [];
            reviews.splice(index, 1);
            localStorage.setItem('reviews', JSON.stringify(reviews));
            displayReviews();
        }
    }

    function displayReviews() {
        const reviews = JSON.parse(localStorage.getItem('reviews')) || [];
        const container = document.getElementById('reviews-container');

        if (reviews.length === 0) {
            container.innerHTML = '<p>Пока нет отзывов. Будьте первым!</p>';
            return;
        }

        container.innerHTML = reviews.map((review, index) => `
            <div class="review">
                <button class="delete-btn" onclick="deleteReview(${index})" title="Удалить отзыв">×</button>
                <div class="review-header">
                    <strong>${review.name}</strong>
                </div>
                <p class="review-psychologist">Психолог: ${getPsychologistName(review.psychologist)}</p>
                <p class="review-text">${review.text}</p>
                <div class="review-date">${review.date}</div>
            </div>
        `).join('');
    }

    document.addEventListener('DOMContentLoaded', function() {
        const reviewForm = document.getElementById('review-form');
        if (reviewForm) {
            reviewForm.addEventListener('submit', function(e) {
                e.preventDefault();

                const name = document.getElementById('review-name').value;
                const psychologist = document.getElementById('review-psychologist').value;
                let text = document.getElementById('review-text').value;

                if (hasBadWords(text) || hasBadWords(name)) {
                    document.getElementById('censorship-warning').style.display = 'block';
                    return false;
                }

                document.getElementById('censorship-warning').style.display = 'none';

                const review = {
                    name: name,
                    psychologist: psychologist,
                    text: text,
                    date: new Date().toLocaleDateString('ru-RU')
                };

                let reviews = JSON.parse(localStorage.getItem('reviews')) || [];
                reviews.unshift(review); 
                localStorage.setItem('reviews', JSON.stringify(reviews));

                this.reset();
                displayReviews();
                alert('Отзыв добавлен! Спасибо!');
            });
        }

        displayReviews();
    });
</script>
</body>
</html>
